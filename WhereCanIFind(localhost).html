<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<link type="text/css" rel="stylesheet" href="http://localhost/YRS2013/CSSmain.css">
		<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
		<!--<script src="http://localhost/YRS2013/JSmain.js"></script>-->
		<script src="http://maps.googleapis.com/maps/api/js?
		key=AIzaSyDVmCT72skg8UIfLNxobO1sGHdguGivzZ8&sensor=false"></script>
		<script>
		function initialize()
		{
			var mapProp = {
				center:new google.maps.LatLng(51.508742,-0.120850),
				zoom:5,
				mapTypeId:google.maps.MapTypeId.ROADMAP
			};
			var map = new google.maps.Map(document.getElementById("googleMap")
  				,mapProp);

		}

		google.maps.event.addDomListener(window, 'load', initialize);



		function call_this() {
			var species = document.forms["input"]["species"].value;
			var postcode = document.forms["input"]["location"].value;
			alert(postcode);

			var url_postcode = "PC.php?postcode=" + postcode;

			var lat = 0;
			var lng = 0;

			$.getJSON(
				url_postcode, function(jsonFile) { alert("success");
				console.log(jsonFile);
				alert("Json found");

				lat = jsonFile["geo"]["lat"];
				lng = jsonFile["geo"]["lng"];
				alert(lat+lng);

				$("#googleMap").remove();
				mapDiv = $("#beforeMap").after("<div id='googleMap'></div>");

				var mapProp = {
					center:new google.maps.LatLng(lat,lng),
					zoom:5,
					mapTypeId:google.maps.MapTypeId.ROADMAP
				};
				var map = new google.maps.Map(document.getElementById("googleMap")
					,mapProp);

				var marker = new google.maps.Marker({
					position: new google.maps.LatLng(lat,lng),
					icon:'purplepin.png'
				});

				marker.setMap(map);
			
			});

			
			return false;
		}
		</script>
		
		

	</head>
	<body>
		<div id="content">
			<div id="reportFeed">
			</div>
			<div id="mainContent">
				<div id="topBox">
					<div id="linkBox">
						<div id="form">
							<form id="inputForm" name="input" action="#" method="post" onsubmit="return call_this()">
								<h2 id="whereCanIFind">Where Can I find...</h2>
								Find: <input type="text" name="species" value="species"><br/>
								Near: <input type="text" name="location" value="postcode"><br/>
								<input type="button" value="Go!" onclick="call_this()">
							</form>
						</div>
						<img id="logo" src="logo.png">
					</div>
				</div>
				<div id="mapHolder"><span id="beforeMap"></span><div id="googleMap"></div></div>
			</div>
		</div>
	</body>
</html>          