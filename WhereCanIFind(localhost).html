<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<link type="text/css" rel="stylesheet" href="http://localhost/YRS2013/CSSmain.css">
		<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
		<!--<script src="http://localhost/YRS2013/JSmain.js"></script>-->
		<script src="http://maps.googleapis.com/maps/api/js?
		key=AIzaSyDVmCT72skg8UIfLNxobO1sGHdguGivzZ8&sensor=false"></script>
		<script>
		function initialize()
		{
			var mapProp = {
				center:new google.maps.LatLng(51.508742,-0.120850),
				zoom:5,
				mapTypeId:google.maps.MapTypeId.ROADMAP
			};
			var map = new google.maps.Map(document.getElementById("googleMap")
  				,mapProp);

		}

		google.maps.event.addDomListener(window, 'load', initialize);



		function call_this() {
			var species = document.forms["input"]["species"].value;
			var postcode = document.forms["input"]["location"].value;
			alert(postcode);

			var url_get = "";

			var url_postcode = "PC.php?postcode=" + postcode;

			var lat = 0;
			var lng = 0;

			$.getJSON(
				url_postcode, function(jsonFile) { 
					alert("success");
					console.log(jsonFile);
					alert("Json found");

					lat = jsonFile["geo"]["lat"];
					lng = jsonFile["geo"]["lng"];
					alert(lat+lng);

					url_get = "getSights.php?"////////////////////////add multiple php args
					var lllist = []

					$.ajax(
						url_get, function(latLngList) {
								lllist = latLngList
						} 
					);



					$("#googleMap").remove();
					mapDiv = $("#beforeMap").after("<div id='googleMap'></div>");

					var mapProp = {
						center:new google.maps.LatLng(lat,lng),
						zoom:10,
						mapTypeId:google.maps.MapTypeId.ROADMAP
					};
					var map = new google.maps.Map(document.getElementById("googleMap")
						,mapProp);

					var marker = new google.maps.Marker({
						position: new google.maps.LatLng(lat,lng),
						icon:'purplepin.png'
					});

					marker.setMap(map);

					var animal0 = new google.maps.Marker({
						position: new google.maps.LatLng(lllist[0][0],lllist[0][1])
					});
					var animal1 = new google.maps.Marker({
						position: new google.maps.LatLng(lllist[1][0],lllist[1][1])
					});
					var animal2 = new google.maps.Marker({
						position: new google.maps.LatLng(lllist[2][0],lllist[2][1])
					});
					var animal3 = new google.maps.Marker({
						position: new google.maps.LatLng(lllist[3][0],lllist[3][1])
					});
					var animal4 = new google.maps.Marker({
						position: new google.maps.LatLng(lllist[4][0],lllist[4][1])
					});

					marker0.setMap(map)
					marker1.setMap(map)
					marker2.setMap(map)
					marker3.setMap(map)
					marker4.setMap(map)
			
			});

			
			return false;
		}

		function logData() {
			var nickname = document.forms["logInput"]["nickname"].value;
			var animal = document.forms["logInput"]["animal"].value;
			var msg = document.forms["logInput"]["msg"].value;
			var postcode = document.forms["logInput"]["msg"].value;

			var url_postcode = "PC.php?postcode=" + postcode;

			var lat = 0;
			var lng = 0;

			$.getJSON(
				url_postcode, function(jsonFile) { 
					alert("connected");
					console.log(jsonFile);
					alert("Json found");

					lat = jsonFile["geo"]["lat"];
					lng = jsonFile["geo"]["lng"];
					alert(lat+lng);
			});



			var url_log = ////////////////////////////////////////////////////add multiple php arguments here///////////////////////////
			$.ajax(url_log);
		}
		</script>
		
		

	</head>
	<body>
		<div id="content">
			<div id="reportFeed">
				<div id="logForm">
					<form id="logForm" name="logInput" action="#" method="post">
						<h2>What did you see?</h2>
						nickname: <input type="text" name="nickname" value=""><br/>
						species: <input type="text" name="animal" value=""><br/>
						message: <br/><textarea name="msg"></textarea><br/>
						postcode: <input type="text" name="postcode" value="">
						<input type="button" value="send!" onclick="logData()">

					</form>
				</div>
			</div>
			<div id="mainContent">
				<div id="topBox">
					<div id="linkBox">
						<div id="form">
							<form id="inputForm" name="input" action="#" method="post" onsubmit="return call_this()">
								<h2 id="whereCanIFind">Where Can I find...</h2>
								<span id="inputLabel">Find:</span>  <input type="text" name="species" value="species"><br/>
								<span id="inputLabel">Near:</span><input type="text" name="location" value="postcode"><br/>
								<input type="button" value="Go!" onclick="call_this()">
							</form>
						</div>
						<img id="logo" src="logo.png">
					</div>
				</div>
				<div id="mapHolder"><span id="beforeMap"></span><div id="googleMap"></div></div>
			</div>
		</div>
	</body>
</html>          